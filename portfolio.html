<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Portfolio | Propix Lk - Modern Gallery</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

    <meta name="theme-color" content="#0b1121">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        brand: { 100: '#03abec', 200: '#1590ef', 300: '#1c86f1', 400: '#2e69f4', 500: '#3d53f7', 600: '#424cf6', 900: '#1a237e' },
                        dark: { bg: '#0b1121', card: '#1e293b', text: '#f8fafc', muted: '#cbd5e1' }
                    },
                    fontFamily: { sans: ['Inter', 'sans-serif'], display: ['Space Grotesk', 'sans-serif'] }
                }
            }
        }
    </script>

    <style>
        /* Base Setup */
        body { 
            overflow: hidden; /* Prevent scrolling for Fixed Layout */
            height: 100vh;
            width: 100vw;
            background-color: #0b1121;
            color: #fff;
        }

        /* Swiper Customization */
        .swiper {
            width: 100%;
            height: 100%;
            padding-top: 2rem;
            padding-bottom: 2rem;
        }
        
        .swiper-slide {
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            /* Default sizing handled by breakpoints in JS */
            height: 80%; /* Give some space top/bottom */
            transition: all 0.5s ease;
            opacity: 0.4;
            transform: scale(0.85);
        }

        .swiper-slide-active {
            opacity: 1;
            transform: scale(1);
            z-index: 10;
        }

        /* Hover effect on slide */
        .swiper-slide:hover {
            opacity: 1;
        }

        .swiper-slide img {
            display: block;
            max-width: 100%;
            max-height: 100%;
            object-fit: cover;
            border-radius: 16px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.6);
        }

        /* Custom Scrollbar for sidebar */
        .sidebar-scroll::-webkit-scrollbar { width: 4px; }
        .sidebar-scroll::-webkit-scrollbar-track { background: #0f172a; }
        .sidebar-scroll::-webkit-scrollbar-thumb { background: #3d53f7; border-radius: 4px; }

        /* Loader */
        .loader {
            border: 3px solid #1e293b;
            border-radius: 50%;
            border-top: 3px solid #3d53f7;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Protection */
        .img-guard {
            position: absolute;
            inset: 0;
            z-index: 50;
        }

        /* Mobile Adjustments */
        @media (max-width: 768px) {
            .mobile-category-bar {
                display: flex;
            }
            .desktop-sidebar {
                display: none;
            }
            .swiper-slide {
                height: 70%;
            }
            .swiper-button-next, .swiper-button-prev {
                display: none; 
            }
        }
    </style>
</head>
<body class="antialiased flex flex-col md:flex-row h-screen">

    <!-- Desktop Sidebar (Navigation & Categories) -->
    <aside class="desktop-sidebar w-72 bg-dark-card border-r border-gray-800 flex flex-col h-full z-20 shadow-2xl">
        <!-- Logo Area -->
        <div class="p-6 border-b border-gray-800 flex items-center justify-between">
            <div class="flex items-center gap-3 cursor-pointer" onclick="window.location.href='index.html'">
                 <div class="h-8 w-8 bg-brand-600 rounded-lg flex items-center justify-center font-bold text-white">P</div>
                 <span class="font-display font-bold text-xl tracking-tight">Propix LK</span>
            </div>
        </div>

        <!-- Categories List -->
        <div class="flex-1 overflow-y-auto sidebar-scroll p-4 space-y-2">
            <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-4 px-2">Collections</h3>
            <nav id="category-nav" class="space-y-1">
                <!-- Categories injected via JS -->
            </nav>
        </div>

        <!-- Footer / Contact Mini -->
        <div class="p-4 border-t border-gray-800 bg-gray-900/50 backdrop-blur">
            <a href="https://wa.me/message/JGOBR5KKO5UAF1" class="flex items-center justify-center gap-2 w-full py-3 bg-brand-600 hover:bg-brand-500 text-white rounded-lg transition shadow-lg group">
                <i data-lucide="message-circle" class="w-4 h-4 group-hover:scale-110 transition-transform"></i>
                <span class="font-medium text-sm">Hire Us</span>
            </a>
            <div class="mt-4 flex justify-between items-center text-xs text-gray-500 px-1">
                <a href="index.html" class="hover:text-brand-400">Home</a>
                <span>&copy; Propix LK</span>
            </div>
        </div>
    </aside>

    <!-- Mobile Category Header (Visible only on mobile) -->
    <div class="mobile-category-bar md:hidden h-16 bg-dark-card border-b border-gray-800 flex items-center px-4 justify-between z-30 relative shrink-0">
        <div class="flex items-center gap-2">
            <div class="h-8 w-8 bg-brand-600 rounded-md flex items-center justify-center font-bold text-white text-sm">P</div>
            <span id="mobile-current-cat" class="font-bold text-white">All Projects</span>
        </div>
        <button id="mobile-menu-toggle" class="p-2 text-gray-400 hover:text-white">
            <i data-lucide="grid" class="w-6 h-6"></i>
        </button>

        <!-- Mobile Dropdown Menu -->
        <div id="mobile-dropdown" class="absolute top-16 left-0 w-full bg-dark-card border-b border-gray-800 shadow-2xl hidden flex-col max-h-[60vh] overflow-y-auto z-40">
            <div id="mobile-cat-list" class="p-2 space-y-1">
                <!-- Mobile categories injected here -->
            </div>
            <div class="p-4 border-t border-gray-800">
                <a href="index.html" class="block text-center py-2 text-sm text-gray-400">Back to Home</a>
            </div>
        </div>
    </div>

    <!-- Main Content Area (Slider) -->
    <main class="flex-1 relative h-full bg-dark-bg overflow-hidden flex flex-col items-center justify-center">
        
        <!-- Background Gradient Mesh (Visual Effect) -->
        <div class="absolute inset-0 z-0 opacity-20 pointer-events-none">
            <div class="absolute top-0 right-0 w-96 h-96 bg-brand-600/30 rounded-full blur-[100px] transform translate-x-1/2 -translate-y-1/2"></div>
            <div class="absolute bottom-0 left-0 w-96 h-96 bg-purple-600/30 rounded-full blur-[100px] transform -translate-x-1/2 translate-y-1/2"></div>
        </div>

        <!-- Swiper Container -->
        <div class="swiper main-swiper w-full z-10">
            <div class="swiper-wrapper" id="swiper-wrapper">
                <!-- Slides injected via JS -->
            </div>
            
            <!-- Add Pagination -->
            <div class="swiper-pagination"></div>
        </div>

        <!-- Info Overlay (Changed to center bottom for gallery style) -->
        <div class="absolute bottom-8 left-0 right-0 z-20 pointer-events-none flex justify-center">
            <div class="bg-black/60 backdrop-blur-md px-6 py-3 rounded-full border border-white/10 shadow-2xl transform translate-y-0 transition-all duration-300 text-center" id="slide-info">
                <div class="flex items-center gap-3">
                    <span class="text-brand-400 text-xs font-bold uppercase tracking-widest" id="info-cat">Category</span>
                    <span class="w-1 h-1 bg-gray-500 rounded-full"></span>
                    <span class="text-white text-sm font-semibold" id="info-title">Creative Design</span>
                    <span class="w-1 h-1 bg-gray-500 rounded-full"></span>
                    <span class="text-gray-400 text-xs" id="info-index">1 / 93</span>
                </div>
            </div>
        </div>

        <!-- Watermark -->
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 pointer-events-none opacity-[0.02] rotate-[-45deg] z-0">
            <span class="text-9xl font-black text-white whitespace-nowrap">PROPIX LK</span>
        </div>

    </main>

    <!-- Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <script>
        // Data from original file
        const categoriesMap = ['Other', 'Other', 'Other', 'Other', 'Other', 'Other', 'Social Media Posts', 'Other', 'Social Media Posts', 'cv', 'Other', 'Class Card', 'Social Media Posts', 'Other', 'Social Media Posts', 'Other', 'Other', 'cv', 'cv', 'cv', 'cv', 'cv', 'cv', 'cv', 'cv', 'flyer', 'flyer', 'flyer', 'flyer', 'flyer', 'flyer', 'Class Card', 'Class Card', 'labal', 'labal', 'labal', 'labal', 'labal', 'labal', 'labal', 'labal', 'labal', 'logo', 'logo', 'logo', 'logo', 'logo', 'visiting card', 'visiting card', 'visiting card', 'visiting card', 'visiting card', 'visiting card', 'book mark', 'book mark', 'book mark', 'book mark', 'book mark', 'book mark', 'book mark', 'cv', 'cv', 'cv', 'cv', 'cv', 'cv', 'cv', 'cv', 'cv', 'cv', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute', 'tute'];
        const extensions = { 2: 'webp', 3: 'jpeg', 5: 'jpeg', 6: 'jpeg', 7: 'jpeg', 8: 'jpeg', 9: 'jpeg', 13: 'jpeg', 14: 'jpeg', 16: 'jpeg', 17: 'webp', 18: 'jpeg', 19: 'jpeg', 20: 'jpeg', 21: 'jpeg', 22: 'jpeg', 23: 'jpeg', 24: 'jpeg', 25: 'jpeg', 30: 'jpeg', 31: 'webp', 33: 'jpeg', 34: 'jpeg', 35: 'jpeg', 36: 'jpeg', 37: 'jpeg', 38: 'jpeg', 39: 'jpeg', 40: 'jpeg', 41: 'jpeg', 42: 'jpeg', 43: 'jpeg', 45: 'jpeg', 46: 'jpeg', 50: 'jpeg', 52: 'jpeg', 53: 'jpeg', 54: 'jpeg', 55: 'webp', 56: 'webp', 57: 'webp', 58: 'jpeg', 59: 'jpeg', 60: 'jpeg', 61: 'jpeg', 72: 'jpeg', 73: 'jpeg', 74: 'jpeg', 75: 'jpeg', 76: 'jpeg', 78: 'jpeg', 82: 'jpeg', 84: 'jpeg', 85: 'jpeg', 86: 'jpeg', 87: 'jpeg', 88: 'jpeg', 89: 'jpeg', 90: 'jpeg', 91: 'jpeg', 92: 'jpeg', 93: 'jpeg' };

        // Generate full items array
        let allItems = [];
        for (let i = 1; i <= 93; i++) {
            allItems.push({
                id: i,
                src: `assets/img/Designs/${i}.${extensions[i] || 'jpg'}`,
                category: categoriesMap[i-1] || 'Other',
                title: `Design Project #${i}`
            });
        }

        // Distinct Categories
        const distinctCategories = ['All', ...new Set(categoriesMap)].map(c => c.charAt(0).toUpperCase() + c.slice(1));
        
        // DOM Elements
        const swiperWrapper = document.getElementById('swiper-wrapper');
        const desktopNav = document.getElementById('category-nav');
        const mobileCatList = document.getElementById('mobile-cat-list');
        const mobileToggle = document.getElementById('mobile-menu-toggle');
        const mobileDropdown = document.getElementById('mobile-dropdown');
        const infoTitle = document.getElementById('info-title');
        const infoCat = document.getElementById('info-cat');
        const infoIndex = document.getElementById('info-index');
        const mobileCurrentCat = document.getElementById('mobile-current-cat');

        let swiperInstance = null;
        let currentFilter = 'All';

        // Initialize UI
        function init() {
            lucide.createIcons();
            renderCategories();
            loadGallery('All');
        }

        // Render Sidebar and Mobile Categories
        function renderCategories() {
            // Helper for creating buttons
            const createBtn = (cat, isMobile) => {
                const btn = document.createElement('button');
                btn.className = `w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 flex items-center justify-between group ${isMobile ? 'hover:bg-gray-800' : ''}`;
                btn.innerHTML = `
                    <span class="cat-name">${cat}</span>
                    <span class="text-xs text-gray-600 bg-gray-900 px-2 py-0.5 rounded-full group-hover:bg-brand-900 group-hover:text-brand-300 transition-colors">
                        ${cat === 'All' ? allItems.length : allItems.filter(i => i.category.toLowerCase() === cat.toLowerCase()).length}
                    </span>
                `;
                btn.onclick = () => {
                    filterGallery(cat);
                    if (isMobile) toggleMobileMenu();
                };
                return btn;
            };

            distinctCategories.forEach(cat => {
                desktopNav.appendChild(createBtn(cat, false));
                mobileCatList.appendChild(createBtn(cat, true));
            });

            // Set initial active state
            updateActiveCategory('All');
        }

        function updateActiveCategory(cat) {
            currentFilter = cat;
            mobileCurrentCat.innerText = cat + " Projects";
            
            // Update Desktop styles
            Array.from(desktopNav.children).forEach(btn => {
                const name = btn.querySelector('.cat-name').innerText;
                if (name === cat) {
                    btn.className = "w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 flex items-center justify-between group bg-brand-600 text-white shadow-brand-glow";
                    btn.querySelector('span:last-child').className = "text-xs text-brand-100 bg-brand-700 px-2 py-0.5 rounded-full";
                } else {
                    btn.className = "w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 flex items-center justify-between group text-gray-400 hover:bg-gray-800 hover:text-white";
                    btn.querySelector('span:last-child').className = "text-xs text-gray-600 bg-gray-900 px-2 py-0.5 rounded-full group-hover:bg-brand-900/50 group-hover:text-brand-300";
                }
            });
        }

        // Filter Logic
        function filterGallery(category) {
            updateActiveCategory(category);
            loadGallery(category);
        }

        // Load Gallery into Swiper
        function loadGallery(category) {
            // Filter items
            const filtered = category === 'All' 
                ? allItems 
                : allItems.filter(item => item.category.toLowerCase() === category.toLowerCase());

            // Destroy existing swiper if exists
            if (swiperInstance) {
                swiperInstance.destroy(true, true);
            }

            // Clear wrapper
            swiperWrapper.innerHTML = '';

            // Build Slides
            filtered.forEach(item => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                slide.setAttribute('data-title', item.title);
                slide.setAttribute('data-category', item.category);
                
                // Optimized Image Loading with Swiper Lazy is simpler, but custom loader provides better UX here
                slide.innerHTML = `
                    <div class="img-guard"></div>
                    <div class="loader absolute z-0"></div>
                    <img src="${item.src}" 
                         alt="${item.title}" 
                         loading="lazy" 
                         class="z-10 relative shadow-2xl"
                         onload="this.previousElementSibling.style.display='none'">
                `;
                swiperWrapper.appendChild(slide);
            });

            // Re-init Swiper
            initSwiper(filtered.length);
            
            // Update info for first slide immediately
            if(filtered.length > 0) updateSlideInfo(0, filtered.length);
        }

        function initSwiper(totalSlides) {
            swiperInstance = new Swiper('.main-swiper', {
                slidesPerView: 1.2, // Show part of next slide on mobile
                centeredSlides: true,
                spaceBetween: 10,
                loop: true,
                speed: 800,
                autoplay: {
                    delay: 2500,
                    disableOnInteraction: false,
                    pauseOnMouseEnter: true
                },
                breakpoints: {
                    640: {
                        slidesPerView: 2.2,
                        spaceBetween: 20,
                    },
                    1024: {
                        slidesPerView: 3.5, // Gallery feel on desktop
                        spaceBetween: 30,
                    },
                    1500: {
                        slidesPerView: 4.5,
                        spaceBetween: 40,
                    }
                },
                pagination: {
                    el: '.swiper-pagination',
                    clickable: true,
                    dynamicBullets: true,
                },
                on: {
                    slideChange: function () {
                        // Use realIndex for looped slides
                        updateSlideInfo(this.realIndex, totalSlides);
                    }
                }
            });
        }

        function updateSlideInfo(index, total) {
            // Find the active slide based on realIndex in loop mode
            // We retrieve data from the original filtered array to ensure accuracy
            let category = currentFilter;
            let title = "Design Project";
            
            // Since we don't have direct access to the item object easily in loop mode without mapping,
            // we can trust the current filter context or look up if needed.
            // Simplified for UX:
            
            const infoBox = document.getElementById('slide-info');
            infoBox.classList.add('opacity-50', 'scale-95');
            
            setTimeout(() => {
                infoTitle.innerText = `${category === 'All' ? 'Portfolio' : category} Design`;
                infoCat.innerText = category;
                infoIndex.innerText = `${index + 1} / ${total}`;
                infoBox.classList.remove('opacity-50', 'scale-95');
            }, 150);
        }

        // Mobile Menu Logic
        function toggleMobileMenu() {
            const isHidden = mobileDropdown.classList.contains('hidden');
            if (isHidden) {
                mobileDropdown.classList.remove('hidden');
                mobileDropdown.classList.add('flex');
            } else {
                mobileDropdown.classList.add('hidden');
                mobileDropdown.classList.remove('flex');
            }
        }
        mobileToggle.onclick = toggleMobileMenu;

        // Anti-save (Basic)
        document.addEventListener('contextmenu', event => event.preventDefault());

        // Initialize
        init();

    </script>
</body>
</html>